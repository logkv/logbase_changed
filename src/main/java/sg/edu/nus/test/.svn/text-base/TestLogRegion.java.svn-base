package sg.edu.nus.test;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;
import java.util.concurrent.atomic.AtomicBoolean;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.concurrent.atomic.AtomicReference;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.KeyValue;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.regionserver.InternalScanner;
import org.apache.hadoop.hbase.regionserver.MyKVStore;
import org.apache.hadoop.hbase.regionserver.TestHRegion;
import org.apache.hadoop.hbase.regionserver.wal.LogScanner;
import org.apache.hadoop.hbase.util.Bytes;

// ================================================================
// class added by huanghao at 20130426-11:30. Test of LogRegion. 
public class TestLogRegion 
{
	public void testGet_Basic() throws Exception 
	{
		TestHRegion test = new TestHRegion();
		test.testGet_Basic();
		System.out.println("Logbase get test on Region level is done.");
	}
	
	
	// we do not support splitting region. we just create new region when conditions are satisfied.
//	public void tesSplitRegion() throws Exception 
//	{
//		TestHRegion test = new TestHRegion();
//		test.tesSplitRegion();
//		System.out.println("Logbase SplitRegion test on Region level is done.");
//	}
//	
	public void testRegionScanner_Next() throws Exception 
	{
		TestHRegion test = new TestHRegion();
		test.testRegionScanner_Next();
	}
	
	public void testScanner_ExplicitColumns_FromMemStore_EnforceVersions() throws Exception 
	{
		TestHRegion test = new TestHRegion();
		test.testScanner_ExplicitColumns_FromMemStore_EnforceVersions();
		System.out.println("done.");
	}
	
	
	/*use the interface in TestHRegion.java 
	 * to test 'put', 'get', 'scan', ...
	 * from the a region level */
	public static void main(String[] args) throws Exception 
	{
		System.out.println("Test LogRegion (i.e, HRegion using LogStores )...");
		
		TestLogRegion test = new TestLogRegion();
		test.testGet_Basic();
		//test.testRegionScanner_Next();
		//test.testScanner_ExplicitColumns_FromMemStore_EnforceVersions();
		
		
	}
	

}
